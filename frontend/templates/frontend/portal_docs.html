<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Stack TÃ©cnico y Arquitectura</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    :root{
      --bg:#0b0f19;--panel:rgba(255,255,255,.06);--panel2:rgba(255,255,255,.04);
      --brd:rgba(255,255,255,.12);--muted:#9ca3af;--txt:#e5e7eb;
      --accent1:rgba(16,185,129,.18);--accent2:rgba(245,158,11,.12);
      --accentSolid:#10b981;--accentSolid2:#f59e0b;
      --green:#34d399;--red:#f87171;--blue:#60a5fa;--yellow:#fde047
    }
    *{box-sizing:border-box}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;margin:0;background:radial-gradient(1200px 600px at 20% -10%,var(--accent1),transparent),radial-gradient(1000px 500px at 110% 10%,var(--accent2),transparent),var(--bg);color:var(--txt)}
    .container{max-width:1100px;margin:0 auto;padding:28px}
    .hero{display:flex;align-items:center;justify-content:space-between;gap:18px;padding:22px 22px;border:1px solid var(--brd);background:linear-gradient(135deg,rgba(16,185,129,.12),rgba(245,158,11,.10));border-radius:18px}
    .hero-title{font-size:26px;font-weight:800;letter-spacing:.3px;color:#f3f4f6}
    .hero-sub{opacity:.9}
    .badges{display:flex;flex-wrap:wrap;gap:8px}
    .badge{padding:6px 10px;border:1px solid var(--brd);background:var(--panel);border-radius:999px;font-size:12px}
    .nav{margin-top:18px;display:flex;flex-wrap:wrap;gap:8px}
    .nav a{display:inline-block;padding:8px 12px;border:1px solid var(--brd);background:var(--panel2);border-radius:10px;color:var(--txt);text-decoration:none;transition:background .18s ease, transform .18s ease}
    .nav a:hover{background:var(--panel);transform:translateY(-1px)}
    .section{margin-top:22px}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:16px}
    .card{background:var(--panel);border:1px solid var(--brd);border-radius:14px;padding:16px;transition:transform .2s ease, box-shadow .2s ease, border-color .2s ease}
    .card:hover{transform:translateY(-2px);box-shadow:0 10px 30px rgba(0,0,0,.28);border-color:rgba(16,185,129,.35)}
    a{color:var(--txt);text-decoration:none}
    a:hover{text-decoration:underline}
    .h2{font-size:18px;font-weight:700;margin:0 0 8px}
    .p{opacity:.92;line-height:1.6;margin:6px 0}
    .chips{margin:8px 0}
    .chip{display:inline-block;border:1px solid var(--brd);background:var(--panel2);border-radius:999px;padding:2px 10px;margin:3px 6px 0 0;font-size:12px}
    ul{margin:10px 0 0 18px}
    li{margin:6px 0}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace}
    .kbd{font-family:inherit;border:1px solid var(--brd);background:var(--panel2);border-radius:6px;padding:2px 6px}
    .endpoint{background:var(--panel);border:1px solid var(--brd);border-radius:10px;padding:10px;margin:6px 0}
    .endpoint .method{display:inline-block;font-weight:700;margin-right:8px}
    .method.get{color:var(--green)}
    .method.post{color:var(--accentSolid2)}
    .muted{color:var(--muted)}
    .footer{margin-top:24px;padding:14px;border-top:1px solid var(--brd);opacity:.8;text-align:center;font-size:14px}
    .icon{display:inline-flex;align-items:center;justify-content:center;width:28px;height:28px;border-radius:8px;background:linear-gradient(135deg,rgba(16,185,129,.25),rgba(245,158,11,.2));margin-right:8px}
    .title{display:flex;align-items:center;margin:0 0 8px;font-weight:800}
    .cta{display:inline-block;padding:10px 14px;border-radius:12px;text-decoration:none}
    .cta.primary{background:var(--accentSolid);color:#031b13;border:1px solid rgba(255,255,255,.18);box-shadow:0 8px 20px rgba(16,185,129,.25);transition:transform .2s ease, box-shadow .2s ease}
    .cta.primary:hover{transform:translateY(-1px);box-shadow:0 10px 28px rgba(16,185,129,.3)}
    .cta.ghost{background:var(--panel2);color:var(--txt);border:1px solid var(--brd)}
    .reveal{opacity:0;transform:translateY(6px);transition:opacity .4s ease, transform .4s ease}
    .reveal.show{opacity:1;transform:none}
    .fab{position:fixed;right:22px;bottom:22px;z-index:50}
    .fab a{padding:12px 16px;border-radius:999px}
  </style>
</head>
<body>
  <div class="container" style="display:grid;grid-template-columns:260px 1fr;gap:18px">
    <aside style="position:sticky;top:18px;height:max-content">
      <div class="card" style="padding:14px">
        <div class="title" style="margin-bottom:6px"><span class="icon">ğŸ“š</span>DocumentaciÃ³n</div>
        <nav id="side-nav" class="nav" style="flex-direction:column;gap:6px;margin:0">
          <a href="#inicio">ğŸ Inicio</a>
          <a href="#acciones">âš¡ Acciones rÃ¡pidas</a>
          <a href="#guia">ğŸ§­ CÃ³mo empezar</a>
          <a href="#arquitectura">ğŸ›ï¸ Arquitectura</a>
          <a href="#backend">âš™ï¸ Backend</a>
          <a href="#frontend">ğŸ–±ï¸ Frontend</a>
          <a href="#datos">ğŸ—ƒï¸ Datos</a>
          <a href="#infra">ğŸ§± Infra</a>
          <a href="#cicd">ğŸš€ CI/CD</a>
          <a href="#endpoints">ğŸ”— Endpoints</a>
          <a href="#aws">â˜ï¸ AWS</a>
          <a href="#postman">ğŸ“® Postman</a>
          <a href="#db">ğŸ—„ï¸ Base de datos</a>
          <a href="#entornos">ğŸŒ— Entornos</a>
          <a href="#seguridad">ğŸ”’ Seguridad</a>
          <a href="#troubleshooting">ğŸ› ï¸ Troubleshooting</a>
          <a href="#devtools">ğŸ§° DevTools</a>
          <a href="/dashboard/horarios/">â¬…ï¸ Volver al Dashboard</a>
        </nav>
      </div>
    </aside>
    <main>
      <div id="inicio" class="hero reveal">
        <div>
          <div class="hero-title">Plataforma de Horarios â€¢ Stack TÃ©cnico</div>
          <div class="hero-sub">Arquitectura clara, validaciones fuertes y una UX pensada para coordinar.</div>
          <div class="badges" style="margin-top:10px">
            <span class="badge">Django 5</span>
            <span class="badge">DRF</span>
            <span class="badge">Celery</span>
            <span class="badge">SQLite</span>
            <span class="badge">Docker</span>
            <span class="badge">GitHub Actions</span>
          </div>
        </div>
        <div class="badges">
          <a href="/dashboard/horarios/" class="cta primary">Ir al Dashboard</a>
          <a href="/validar/" class="cta ghost">Validar datos</a>
          <a href="/swagger/" class="cta ghost">Abrir Swagger</a>
        </div>
      </div>

      <div id="acciones" class="section">
        <div class="grid">
          <a class="card reveal" href="/dashboard/horarios/" style="text-decoration:none">
            <div class="title"><span class="icon">ğŸ“…</span>Ver todos los horarios</div>
            <div class="p">Explora la grilla completa por curso, con drag & drop y validaciones.</div>
          </a>
          <a class="card reveal" href="/validar/" style="text-decoration:none">
            <div class="title"><span class="icon">âœ…</span>Validar datos maestros</div>
            <div class="p">Revisa disponibilidad de profesores y materias sin asignaciÃ³n.</div>
          </a>
          <a class="card reveal" href="/swagger/" style="text-decoration:none">
            <div class="title"><span class="icon">ğŸ§¾</span>DocumentaciÃ³n API</div>
            <div class="p">Consulta y prueba endpoints REST desde Swagger UI.</div>
          </a>
          <a class="card reveal" href="/cursos/" style="text-decoration:none">
            <div class="title"><span class="icon">ğŸ·ï¸</span>Lista de cursos</div>
            <div class="p">Explora cursos paginados para ubicar horarios o exportar.</div>
          </a>
          <a class="card reveal" href="/profesores/" style="text-decoration:none">
            <div class="title"><span class="icon">ğŸ‘©â€ğŸ«</span>Lista de profesores</div>
            <div class="p">Navega la disponibilidad y horarios por docente.</div>
          </a>
        </div>
      </div>

      <div id="guia" class="section">
        <div class="card reveal">
          <div class="title"><span class="icon">ğŸ§­</span>CÃ³mo empezar (5 pasos rÃ¡pidos)</div>
          <ol style="margin:10px 0 0 18px;line-height:1.7">
            <li>Ir a <strong>Validar datos</strong> para detectar faltantes: <span class="mono">/validar/</span></li>
            <li><strong>Generar horarios</strong> desde el panel o script, segÃºn entorno.</li>
            <li>Revisar el <strong>Dashboard</strong>: <span class="mono">/dashboard/horarios/</span></li>
            <li>Ajustar manualmente con <strong>arrastrar/soltar</strong> (verde permitido, rojo bloqueado).</li>
            <li><strong>Exportar</strong> por curso en PDF: <span class="mono">/pdf/curso/&lt;id&gt;/</span></li>
          </ol>
        </div>
      </div>
    <div class="section" id="arquitectura">
      <div class="grid">
        <div class="card reveal">
          <div class="title"><span class="icon">ğŸ›ï¸</span>Arquitectura</div>
          <div class="p">Hexagonal con capas separadas. Dominio, aplicaciÃ³n e infraestructura con responsabilidades claras y testables.</div>
          <ul>
            <li>Dominio y validaciones: <span class="mono">horarios/domain/validators/</span></li>
            <li>Servicios de aplicaciÃ³n: <span class="mono">horarios/application/services/</span></li>
            <li>Adaptadores y exportaciÃ³n: <span class="mono">horarios/infrastructure/adapters/</span></li>
          </ul>
        </div>
        <div class="card reveal">
          <div class="title"><span class="icon">ğŸ§ </span>Algoritmo</div>
          <div class="p">Demand-First con estructuras O(1) y reglas duras. Intercambios atÃ³micos garantizan consistencia al mover bloques.</div>
          <ul>
            <li>Servicio: <span class="mono">GeneradorDemandFirst</span></li>
            <li>Reglas de negocio centralizadas</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="section" id="backend">
      <div class="grid">
        <div class="card reveal">
          <div class="title"><span class="icon">âš™ï¸</span>Backend</div>
          <div class="chips">
            <span class="chip">Django 5</span><span class="chip">DRF</span><span class="chip">Swagger</span><span class="chip">Celery</span><span class="chip">xhtml2pdf</span>
          </div>
          <ul>
            <li>API documentada en <span class="mono">/swagger/</span></li>
            <li>ExportaciÃ³n PDF por curso</li>
            <li>Tareas en Celery con fallback sÃ­ncrono</li>
          </ul>
        </div>
        <div class="card reveal">
          <div class="title"><span class="icon">ğŸ§ª</span>Validaciones</div>
          <div class="p">Precondiciones y reglas duras verificadas antes y durante la generaciÃ³n.</div>
          <ul>
            <li>DiagnÃ³stico en <span class="mono">/validar/</span></li>
            <li>Suite de pruebas enfocada en negocio</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="section" id="frontend">
      <div class="grid">
        <div class="card reveal">
          <div class="title"><span class="icon">ğŸ–±ï¸</span>Frontend</div>
          <div class="chips">
            <span class="chip">HTML</span><span class="chip">JS</span><span class="chip">Estilos propios</span>
          </div>
          <ul>
            <li>Arrastrar/soltar con prevalidaciÃ³n visual</li>
            <li>Persistencia vÃ­a AJAX a <span class="mono">/mover-horario-ajax/</span></li>
            <li>Colores calmados y accesibilidad</li>
          </ul>
        </div>
        <div class="card reveal">
          <div class="title"><span class="icon">ğŸ§­</span>UX</div>
          <ul>
            <li>Verde: drop permitido</li>
            <li>Rojo: conflicto de profesor o bloque ocupado</li>
            <li>Mensajes de Ã©xito/error no intrusivos</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="section" id="datos">
      <div class="grid">
        <div class="card reveal">
          <div class="title"><span class="icon">ğŸ—ƒï¸</span>Datos y Concurrencia</div>
          <div class="chips">
            <span class="chip">SQLite</span><span class="chip">Transacciones</span><span class="chip">Ãndices</span>
          </div>
          <ul>
            <li>Swaps protegidos por <span class="mono">transaction.atomic()</span></li>
            <li>Timeouts ampliados ante bloqueos</li>
          </ul>
        </div>
        <div class="card reveal">
          <div class="title"><span class="icon">ğŸ“Š</span>Reportes</div>
          <ul>
            <li>ExportaciÃ³n CSV/PDF</li>
            <li>EstadÃ­sticas de horarios</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="section" id="infra">
      <div class="grid">
        <div class="card reveal">
          <div class="title"><span class="icon">ğŸ§±</span>Infraestructura</div>
          <div class="chips">
            <span class="chip">Docker</span><span class="chip">Nginx</span><span class="chip">HTTPS opcional</span>
          </div>
          <ul>
            <li>Despliegue simple y reproducible</li>
            <li>Build local de imÃ¡genes</li>
          </ul>
        </div>
        <div class="card reveal">
          <div class="title"><span class="icon">ğŸ”</span>Seguridad</div>
          <ul>
            <li>CSRF en movimientos AJAX</li>
            <li>Rutas de administraciÃ³n aislables</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="section" id="cicd">
      <div class="grid">
        <div class="card reveal">
          <div class="title"><span class="icon">ğŸš€</span>CI/CD y Calidad</div>
          <div class="chips">
            <span class="chip">GitHub Actions</span><span class="chip">Pytest</span>
          </div>
          <ul>
            <li>26 tests clave pasando</li>
            <li>Warnings controlados en entorno de test</li>
          </ul>
        </div>
        <div class="card reveal">
          <div class="title"><span class="icon">ğŸ§­</span>GuÃ­as</div>
          <ul>
            <li>Endpoints documentados</li>
            <li>Estrategias de migraciÃ³n y despliegue</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="section" id="endpoints">
      <div class="card reveal">
        <div class="title"><span class="icon">ğŸ”—</span>Endpoints Ãºtiles</div>
        <div class="endpoint"><span class="method get">GET</span> <span class="mono">/swagger/</span> DocumentaciÃ³n interactiva</div>
        <div class="endpoint"><span class="method get">GET</span> <span class="mono">/dashboard/horarios/</span> Vista general de horarios</div>
        <div class="endpoint"><span class="method get">GET</span> <span class="mono">/validar/</span> DiagnÃ³stico de datos maestros</div>
        <div class="endpoint"><span class="method get">GET</span> <span class="mono">/pdf/curso/&lt;id&gt;/</span> ExportaciÃ³n PDF por curso</div>
        <div class="muted" style="margin-top:8px">Sugerencia: usa <span class="kbd">Ctrl</span>+<span class="kbd">Click</span> para abrir en nueva pestaÃ±a.</div>
      </div>
    </div>

      <div class="section" id="aws">
        <div class="grid">
          <div class="card reveal">
            <div class="title"><span class="icon">â˜ï¸</span>AWS â€¢ Despliegue</div>
            <div class="chips"><span class="chip">EC2 t3.micro</span><span class="chip">Ubuntu 24.04</span><span class="chip">Docker Compose</span><span class="chip">Nginx</span></div>
            <ul>
              <li>Instancia: t3.micro, Ubuntu 24.04, protecciÃ³n contra terminaciÃ³n activada</li>
              <li>Puertos: 22, 80, 443 en el Security Group</li>
              <li>HTTPS opcional con Nginx y certificados locales</li>
              <li>ImÃ¡genes Docker construidas localmente y subidas a Docker Hub</li>
            </ul>
          </div>
          <div class="card reveal">
            <div class="title"><span class="icon">ğŸ’¸</span>Estrategia de costo</div>
            <ul>
              <li>Modo bajo costo: detener instancia cuando no se usa</li>
              <li>Monitoreo detallado desactivado por costo</li>
              <li>Limpieza mensual de imÃ¡genes: <span class="mono">docker system prune -af</span></li>
            </ul>
          </div>
        </div>
      </div>

      <div class="section" id="postman">
        <div class="grid">
          <div class="card reveal">
            <div class="title"><span class="icon">ğŸ“®</span>Postman â€¢ Importar API</div>
            <ul>
              <li>Exporta OpenAPI desde <span class="mono">/swagger/?format=openapi</span></li>
              <li>Importa el JSON en Postman como colecciÃ³n</li>
              <li>AutenticaciÃ³n: <span class="mono">Authorization: Bearer &lt;token&gt;</span></li>
              <li>ObtÃ©n token en <span class="mono">/api/token/</span> y refresca en <span class="mono">/api/token/refresh/</span></li>
            </ul>
          </div>
          <div class="card reveal">
            <div class="title"><span class="icon">ğŸ”‘</span>Flujo de autenticaciÃ³n</div>
            <ul>
              <li>Credenciales via POST: <span class="mono">{\"username\",\"password\"}</span></li>
              <li>Usa el access token en el header para llamadas DRF</li>
            </ul>
          </div>
        </div>
      </div>

      <div class="section" id="db">
        <div class="grid">
          <div class="card reveal">
            <div class="title"><span class="icon">ğŸ—„ï¸</span>Base de datos</div>
            <div class="chips"><span class="chip">SQLite</span><span class="chip">PostgreSQL (opcional)</span></div>
            <ul>
              <li>ProducciÃ³n: SQLite con timeout ampliado y swaps atÃ³micos</li>
              <li>Opcional PostgreSQL: define <span class="mono">DB_ENGINE=django.db.backends.postgresql</span> y credenciales</li>
              <li>Variables: <span class="mono">DB_NAME, DB_USER, DB_PASSWORD, DB_HOST, DB_PORT</span></li>
              <li>Migraciones: <span class="mono">python manage.py migrate</span></li>
            </ul>
          </div>
          <div class="card reveal">
            <div class="title"><span class="icon">ğŸ”§</span>OptimizaciÃ³n</div>
            <ul>
              <li>Uso de <span class="mono">select_related/prefetch_related</span> para evitar N+1</li>
              <li>Ãndices en claves de consulta frecuentes</li>
            </ul>
          </div>
        </div>
      </div>

      <div class="section" id="entornos">
        <div class="grid">
          <div class="card reveal">
            <div class="title"><span class="icon">ğŸŒ—</span>Entornos</div>
            <ul>
              <li>SeparaciÃ³n Dev/Prod estricta</li>
              <li>Variables de entorno en <span class="mono">.env</span> del servidor</li>
              <li>No activar <span class="mono">DEBUG=True</span> en producciÃ³n</li>
            </ul>
          </div>
          <div class="card reveal">
            <div class="title"><span class="icon">ğŸ§©</span>.env requerido</div>
            <ul>
              <li><span class="mono">PROD_IP</span>, <span class="mono">DJANGO_DEBUG=False</span>, credenciales BD</li>
              <li>InyecciÃ³n por Docker Compose</li>
            </ul>
          </div>
        </div>
      </div>

      <div class="section" id="seguridad">
        <div class="grid">
          <div class="card reveal">
            <div class="title"><span class="icon">ğŸ”’</span>Seguridad</div>
            <ul>
              <li>CSRF en operaciones AJAX</li>
              <li>HTTPS con Nginx y certificados locales</li>
              <li>Admin protegible via variable de ruta</li>
            </ul>
          </div>
          <div class="card reveal">
            <div class="title"><span class="icon">ğŸ§±</span>Red</div>
            <ul>
              <li>Puertos abiertos: 22, 80, 443</li>
              <li>Certificados montados en Nginx</li>
            </ul>
          </div>
        </div>
      </div>

      <div class="section" id="troubleshooting">
        <div class="grid">
          <div class="card reveal">
            <div class="title"><span class="icon">ğŸ› ï¸</span>Problemas comunes</div>
            <ul>
              <li>Nginx SSL ausente: error al iniciar si faltan certificados</li>
              <li><span class="mono">database is locked</span>: incrementar timeout en SQLite</li>
              <li>Espacio en disco: ejecutar <span class="mono">docker system prune -af</span></li>
              <li>HTTPS inaccesible: verificar <span class="mono">PROD_IP</span> y coincidencia en el certificado</li>
            </ul>
          </div>
          <div class="card reveal">
            <div class="title"><span class="icon">ğŸ“¦</span>Despliegue</div>
            <ul>
              <li>Construir imÃ¡genes localmente y publicar en Docker Hub</li>
              <li>Levantar con <span class="mono">docker compose -f docker-compose.prod.yml up -d</span></li>
            </ul>
          </div>
        </div>
      </div>

      <div class="section" id="devtools">
        <div class="grid">
          <div class="card reveal">
            <div class="title"><span class="icon">ğŸ§°</span>Herramientas de desarrollo</div>
            <ul>
              <li>Runserver: <span class="mono">python manage.py runserver</span></li>
              <li>Migraciones: <span class="mono">python manage.py makemigrations</span> y <span class="mono">migrate</span></li>
              <li>Pruebas: <span class="mono">pytest</span> con foco en reglas de negocio</li>
            </ul>
          </div>
          <div class="card reveal">
            <div class="title"><span class="icon">ğŸ§ª</span>Pruebas clave</div>
            <ul>
              <li>Integridad de datos</li>
              <li>Reglas de negocio</li>
              <li>Flujo del sistema completo</li>
            </ul>
          </div>
        </div>
      </div>

    <div class="footer">Â© Plataforma de Horarios â€” Arquitectura limpia y UX clara</div>
    </main>
  </div>
  <div class="fab">
    <a href="/dashboard/horarios/" class="cta primary">Volver al Dashboard</a>
  </div>
  <script>
    document.querySelectorAll('a[href^="#"]').forEach(a=>{
      a.addEventListener('click',e=>{
        const id=a.getAttribute('href').slice(1);
        const el=document.getElementById(id);
        if(el){e.preventDefault();el.scrollIntoView({behavior:'smooth',block:'start'});}
      });
    });
    const navLinks=[...document.querySelectorAll('#side-nav a')];
    const sections=navLinks.map(l=>document.getElementById(l.getAttribute('href').slice(1))).filter(Boolean);
    const obs=new IntersectionObserver(entries=>{
      entries.forEach(entry=>{
        const id=entry.target.id;
        const link=navLinks.find(l=>l.getAttribute('href')==='#'+id);
        if(link){
          if(entry.isIntersecting){
            navLinks.forEach(n=>n.style.background='var(--panel2)');
            link.style.background='var(--panel)';
          }
        }
      });
    },{root:null,rootMargin:'-40% 0px -55% 0px',threshold:0.01});
    sections.forEach(s=>obs.observe(s));
    const reveals=[...document.querySelectorAll('.reveal')];
    const obs2=new IntersectionObserver(es=>{
      es.forEach(e=>{
        if(e.isIntersecting){e.target.classList.add('show');obs2.unobserve(e.target);}
      });
    },{threshold:.1});
    reveals.forEach(el=>obs2.observe(el));
  </script>
</body>
</html>
